<!DOCTYPE html> 
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title></title>
		<script type="text/javascript" src="libs/d3.v4.js"></script>
		<link rel="stylesheet" href="main.css" />
	</head>

	<body>
		<div id="main-container">
			<div id="sidebar">
				<svg id="sidebar-canvas" width="100%" height="100%"></svg>
				  <form id="country-form" onSubmit="return handleClick()">
		            <input type="text" class="headline" id="country-field" placeholder="country">
		        </form>
			</div>
			<div id="map-container"></div>
		</div>

		<script type="text/javascript">

			/**
			Global variables
			*/
			var svgCanvas;

			/**
			Load Data
			*/
			var foodWasteData = [{
				iso : "DK",
				valueMillions: "2343.5",
				year: 2009
			}];

			var bigMacIDX;

			d3.csv("BigMacIDX.csv", function(data){ 
				bigMacIDX = data;
				//console.log(data[0]);
			});		

			/**
			Load Resources
			*/
			d3.xml("resources/WorldMap_COUNTRYCODE.svg").mimeType("image/svg+xml").get(function(error, xml) {
			  if (error) throw error;
			  var svg = xml.documentElement;
			  svg.id = "map";
			  document.getElementById("map-container").appendChild(svg);
			  svgCanvas = d3.select("#map");
			  drawMainInterface();		  
			});			

			function sortByPosition(a, b){
			  if (a.y == b.y) return a.x - b.x;
			  return a.y - b.y;
			}

			function drawMainInterface(){												
				svgCanvas.selectAll("circle").style("opacity", 0);
				var circles = svgCanvas.selectAll("circle");
			
				circles.transition()
					.duration(250)
					.delay(function(d,i) { return i * 0.5; })
					.style("opacity", 1);
				
				drawCurve(0,0, 100, 50);
				drawSidebar();
			}

			function drawCurve(fromX, fromY, toX, toY){

				var dataArray = [{x:fromX, y:fromY},{x:toX / 2, y:fromY + 50},{x:toX, y:toY}];				
				var group = svgCanvas.append("g").attr("class","group1");

			 	var lineGenerator = d3.line()
                         .x(function(d) { return d.x; })
                         .y(function(d) { return d.y; })
                         .curve(d3.curveBasis);

			    group.append("path")
				.style("fill","none")
				.style("stroke","#999999")
				.style("stroke-width","2px")
				.style("stroke-dasharray", [10,5])
				.attr("d",function(d,i){ return lineGenerator(dataArray); });
			}


			function drawSidebar(){
				//TODO
				var sidebar=d3.select("#sidebar-canvas");
				var title = sidebar.append("text")
				.attr("class", "title")
				.attr("x", 45)
				.attr("y", 45)
				.text("I live in");




			}

		</script>
	</body>

</html>